TEMPLATEBUILDER.TSX - EXTRACTION SUMMARY

File analyzed: pagevoo-frontend/src/pages/TemplateBuilder.tsx (5,019 lines)

KEY FINDINGS:

1. RENDER SECTION FUNCTION IS MONOLITHIC (1,164 lines)
   - Lines 3269-4403
   - Contains 10+ different section types
   - Each section type has its own rendering logic
   - Includes navbar (348 lines), footer (67 lines), hero (30 lines), etc.
   - OPPORTUNITY: Extract into 9-10 separate components

2. NAVBAR COMPONENT IS LARGEST SUBSECTION (348 lines)
   - Lines 3964-4312 within renderSection
   - Complex dropdown menu logic
   - Multiple helper functions for styling
   - Mobile menu integration
   - OPPORTUNITY: Extract to components/sections/navbar/

3. TEXT EDITOR LOGIC SCATTERED (300+ lines)
   - Lines 1779-2600
   - 30 handler functions for text editing
   - Image manipulation, alt text, dimensions
   - Link insertion/removal
   - OPPORTUNITY: Extract to 3 custom hooks

4. PAGE TEMPLATES ARE EMBEDDED (200 lines)
   - Lines 1070-1270 in handleAddPageFromTemplate
   - Pure template data
   - Not functional code
   - OPPORTUNITY: Move to data/pageTemplates.ts (QUICK WIN)

5. STATE EXPLOSION (88 VARIABLES)
   - useState hooks scattered throughout
   - Many related to specific features (text editing, modals, etc.)
   - OPPORTUNITY: Group related state into custom hooks

6. HANDLER FUNCTIONS ARE EXCESSIVE (60+ handlers)
   - Page management (10)
   - Section management (6)
   - Text editing (15)
   - Image handling (10+)
   - Modal management (10+)
   - OPPORTUNITY: Organize into utility files/hooks

7. MODAL RENDERING BLOATED (260 lines)
   - Lines 4756-5015
   - 10 different modals
   - Each modal needs 5-20 lines to render
   - OPPORTUNITY: Create ModalManager component

EXTRACTION IMPACT:

Phase 1 - Quick Wins (2-3 hours):
  Page Templates (200 lines) → data/pageTemplates.ts
  EditableText (18 lines) → components/EditableText.tsx
  PositionIndicators (29 lines) → components/sections/PositionIndicators.tsx
  SUBTOTAL: 247 lines, ~1.5 hours

Phase 2 - Section Components (5-6 hours):
  Hero (30 lines) → components/sections/HeroSection.tsx
  Gallery (19 lines) → components/sections/GallerySection.tsx
  Grid (59 lines) → components/sections/GridSection.tsx
  Contact Form (73 lines) → components/sections/ContactFormSection.tsx
  Footer (67 lines) → components/sections/FooterSection.tsx
  Section Wrapper (173 lines) → components/sections/SectionWrapper.tsx
  SUBTOTAL: 421 lines, ~5-6 hours

Phase 3 - Major Components (13-15 hours):
  Navbar Section (348 lines) → components/sections/navbar/
  Text Editor Hooks (300 lines) → hooks/
  Modal Manager (180 lines) → components/modals/ModalManager.tsx
  SUBTOTAL: 828 lines, ~13-15 hours

TOTAL IMPACT:
  Lines to extract: 1,496 lines (30%)
  Final TemplateBuilder size: 3,523 lines
  New files to create: 15-17
  Total effort: 19-22 hours
  Complexity reduction: 50%+ estimated

BEST CANDIDATES FOR IMMEDIATE EXTRACTION:

#1 NAVBAR SECTION (348 lines, 7 hours)
   - Self-contained section type
   - Complex but isolated logic
   - Would significantly reduce file size

#2 TEXT EDITOR HOOKS (300 lines, 6 hours)
   - Extract as custom hooks
   - Highly reusable across project
   - Cleanest extraction path

#3 PAGE TEMPLATES (200 lines, 20 minutes)
   - Pure data, no dependencies
   - Quickest win
   - Do this first!

REMAINING RECOMMENDATIONS:

- Individual section components (Hero, Gallery, etc.) - 250 lines
- Modal manager consolidation - 180 lines
- CSS helper reorganization - depends on other work
- State management refactor - depends on above

FILES TO CREATE (Priority Order):

1. data/pageTemplates.ts (200 lines)
2. components/EditableText.tsx (18 lines)
3. components/sections/HeroSection.tsx (30 lines)
4. components/sections/GallerySection.tsx (19 lines)
5. components/sections/GridSection.tsx (59 lines)
6. components/sections/ContactFormSection.tsx (73 lines)
7. components/sections/FooterSection.tsx (67 lines)
8. components/sections/PositionIndicators.tsx (29 lines)
9. components/sections/SectionWrapper.tsx (173 lines)
10. components/sections/navbar/NavbarSection.tsx (216 lines)
11. components/sections/navbar/LinkItem.tsx (60 lines)
12. components/sections/navbar/DropdownMenu.tsx (80 lines)
13. components/sections/navbar/navbarUtils.ts (40 lines)
14. hooks/useTextEditor.ts (150 lines)
15. hooks/useImageSettings.ts (80 lines)
16. hooks/useTextFormatting.ts (70 lines)
17. components/modals/ModalManager.tsx (180 lines)

STATE MANAGEMENT ANALYSIS:

Current state variables: 88

Can be moved to hooks:
  - Text editing state (12) → useTextEditor
  - Image settings (10) → useImageSettings
  - Modal visibility (15) → useModalManager
  - Page editing (8) → usePageManager
  
Remaining in main component: ~43 variables
Expected reduction: 50% fewer state variables in main

COMPLEXITY ANALYSIS:

Current:
  - 1 component file (5,019 lines)
  - 1 renderSection function (1,164 lines)
  - 88 state variables
  - 60+ handler functions
  - Estimated McCabe complexity: 800+

After extraction:
  - 17 new component files
  - renderSection function (250-300 lines)
  - ~43 state variables in main component
  - 20-30 handler functions in main
  - Estimated McCabe complexity: 350-400
  - Overall code maintainability: DRAMATICALLY IMPROVED

DEPENDENCIES TO MAINTAIN:

Critical imports:
  - React hooks
  - dnd-kit (drag and drop)
  - API calls
  - Component imports (modals, panels)

State management:
  - template, currentPage, selectedSection
  - DND state (activeId, overId, etc.)
  - UI state (showLeftSidebar, viewport, etc.)

Props to extracted components:
  - section (TemplateSection)
  - content (section content object)
  - selectedSection
  - handlers (update, delete, move, etc.)

TESTING CONSIDERATIONS:

After extraction, test:
  1. Navbar rendering and interactions
  2. Text editor functionality
  3. Section addition/deletion
  4. Page creation/editing
  5. Modal opening/closing
  6. Drag and drop functionality
  7. Responsive layout at different viewports

RISK ASSESSMENT:

Low risk (straightforward extraction):
  - Page Templates
  - EditableText component
  - Individual section components

Medium risk (interdependencies):
  - Text Editor hooks (multiple state vars)
  - Modal Manager (multiple modals)

High risk (complex interactions):
  - Navbar Section (dropdown, styling, mobile menu)
  - renderSection refactoring (orchestration)

NEXT STEPS:

1. Confirm extraction scope with team
2. Start with Page Templates (quick win)
3. Extract EditableText component
4. Extract simple section components
5. Plan Navbar extraction carefully
6. Implement Text Editor hooks
7. Consolidate Modal rendering
8. Testing and bug fixes
9. Documentation updates

ESTIMATED TIMELINE:

Week 1: Quick wins (Page Templates, EditableText) - 1 hour
Week 2: Section components (Hero, Gallery, Grid, Contact, Footer) - 6 hours
Week 3: Major refactors (Navbar, Text Editor) - 12 hours
Week 4: Modal consolidation, testing, cleanup - 8 hours

TOTAL: 27 hours (3-4 weeks at 1-2 hours/day)

Result: 30% smaller, 50% less complex, more maintainable codebase
